// SPDX-License-Identifier: Apache-2.0
//
// quadriga-lib c++/MEX Utility library for radio channel modelling and simulations
// Copyright (C) 2022-2025 Stephan Jaeckel (https://sjc-wireless.com)
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ------------------------------------------------------------------------

#include "quadriga_tools.hpp"

/*!SECTION
Miscellaneous tools
SECTION!*/

/*!MD
# colormap
Generate colormap

## Description:
- Returns a 64x3 colormap matrix with RGB values in unsigned char format.
- Each row corresponds to an RGB color entry of the selected colormap.
- Useful for visualization purposes (e.g., heatmaps or 3D rendering).
- Available color maps include: `jet`, `parula`, `winter`, `hot`, `turbo`, `copper`, `spring`, `cool`, `gray`, `autumn`, `summer`.

## Declaration:
```
arma::uchar_mat quadriga_lib::colormap(std::string map)
```

## Arguments:
- `std::string **map**` (input)<br>
  Name of the desired colormap. Must be one of:
  `"jet"`, `"parula"`, `"winter"`, `"hot"`, `"turbo"`, `"copper"`, `"spring"`, `"cool"`, `"gray"`, `"autumn"`, `"summer"`.

## Returns:
- `arma::uchar_mat`<br>
  A matrix of size `[64 x 3]` containing RGB color values as unsigned chars in the range `[0, 255]`.

## Example:
```
arma::uchar_mat cm = quadriga_lib::colormap("turbo");
```
MD!*/

// Generate colormap
arma::uchar_mat quadriga_lib::colormap(std::string map)
{
    /*! MATLAB code to generate colormap:
        clc
        cmap_values = round( feval('jet', 64)*255 );
        str = '{';
        for i = 1:size(cmap_values,1)
            str = [str, sprintf('{%d,%d,%d},',cmap_values(i,:))];
            if (mod(i,8) == 0)
                str = [str, '\n'];
            end
        end
        str = [str(1:end-3), '};\n'];
        fprintf(str)
    !*/

    arma::uchar_mat cmap(64, 3);
    if (map == "jet")
        cmap = {{0, 0, 143}, {0, 0, 159}, {0, 0, 175}, {0, 0, 191}, {0, 0, 207}, {0, 0, 223}, {0, 0, 239}, {0, 0, 255}, {0, 16, 255}, {0, 32, 255}, {0, 48, 255}, {0, 64, 255}, {0, 80, 255}, {0, 96, 255}, {0, 112, 255}, {0, 128, 255}, {0, 143, 255}, {0, 159, 255}, {0, 175, 255}, {0, 191, 255}, {0, 207, 255}, {0, 223, 255}, {0, 239, 255}, {0, 255, 255}, {16, 255, 239}, {32, 255, 223}, {48, 255, 207}, {64, 255, 191}, {80, 255, 175}, {96, 255, 159}, {112, 255, 143}, {128, 255, 128}, {143, 255, 112}, {159, 255, 96}, {175, 255, 80}, {191, 255, 64}, {207, 255, 48}, {223, 255, 32}, {239, 255, 16}, {255, 255, 0}, {255, 239, 0}, {255, 223, 0}, {255, 207, 0}, {255, 191, 0}, {255, 175, 0}, {255, 159, 0}, {255, 143, 0}, {255, 128, 0}, {255, 112, 0}, {255, 96, 0}, {255, 80, 0}, {255, 64, 0}, {255, 48, 0}, {255, 32, 0}, {255, 16, 0}, {255, 0, 0}, {239, 0, 0}, {223, 0, 0}, {207, 0, 0}, {191, 0, 0}, {175, 0, 0}, {159, 0, 0}, {143, 0, 0}, {128, 0, 0}};
    else if (map == "parula")
        cmap = {{62, 38, 168}, {64, 42, 180}, {66, 46, 192}, {68, 50, 203}, {69, 55, 213}, {70, 60, 222}, {71, 65, 229}, {71, 71, 235}, {72, 77, 240}, {72, 82, 244}, {71, 88, 248}, {70, 94, 251}, {69, 99, 253}, {66, 105, 254}, {62, 111, 255}, {56, 117, 254}, {50, 124, 252}, {47, 129, 250}, {46, 135, 247}, {45, 140, 243}, {43, 145, 239}, {39, 151, 235}, {37, 155, 232}, {35, 160, 229}, {32, 165, 227}, {28, 169, 223}, {24, 173, 219}, {18, 177, 214}, {8, 181, 208}, {1, 184, 202}, {2, 186, 195}, {11, 189, 189}, {25, 191, 182}, {36, 193, 174}, {44, 196, 167}, {49, 198, 159}, {55, 200, 151}, {63, 202, 142}, {74, 203, 132}, {87, 204, 122}, {100, 205, 111}, {114, 205, 100}, {129, 204, 89}, {143, 203, 78}, {157, 201, 67}, {171, 199, 57}, {185, 196, 49}, {197, 194, 42}, {209, 191, 39}, {220, 189, 41}, {230, 187, 45}, {240, 186, 54}, {248, 186, 61}, {254, 190, 60}, {254, 195, 56}, {254, 201, 52}, {252, 207, 48}, {250, 214, 45}, {247, 220, 42}, {245, 227, 39}, {245, 233, 36}, {246, 239, 32}, {247, 245, 27}, {249, 251, 21}};
    else if (map == "winter")
        cmap = {{0, 0, 255}, {0, 4, 253}, {0, 8, 251}, {0, 12, 249}, {0, 16, 247}, {0, 20, 245}, {0, 24, 243}, {0, 28, 241}, {0, 32, 239}, {0, 36, 237}, {0, 40, 235}, {0, 45, 233}, {0, 49, 231}, {0, 53, 229}, {0, 57, 227}, {0, 61, 225}, {0, 65, 223}, {0, 69, 221}, {0, 73, 219}, {0, 77, 217}, {0, 81, 215}, {0, 85, 213}, {0, 89, 210}, {0, 93, 208}, {0, 97, 206}, {0, 101, 204}, {0, 105, 202}, {0, 109, 200}, {0, 113, 198}, {0, 117, 196}, {0, 121, 194}, {0, 125, 192}, {0, 130, 190}, {0, 134, 188}, {0, 138, 186}, {0, 142, 184}, {0, 146, 182}, {0, 150, 180}, {0, 154, 178}, {0, 158, 176}, {0, 162, 174}, {0, 166, 172}, {0, 170, 170}, {0, 174, 168}, {0, 178, 166}, {0, 182, 164}, {0, 186, 162}, {0, 190, 160}, {0, 194, 158}, {0, 198, 156}, {0, 202, 154}, {0, 206, 152}, {0, 210, 150}, {0, 215, 148}, {0, 219, 146}, {0, 223, 144}, {0, 227, 142}, {0, 231, 140}, {0, 235, 138}, {0, 239, 136}, {0, 243, 134}, {0, 247, 132}, {0, 251, 130}, {0, 255, 128}};
    else if (map == "hot")
        cmap = {{11, 0, 0}, {21, 0, 0}, {32, 0, 0}, {43, 0, 0}, {53, 0, 0}, {64, 0, 0}, {74, 0, 0}, {85, 0, 0}, {96, 0, 0}, {106, 0, 0}, {117, 0, 0}, {128, 0, 0}, {138, 0, 0}, {149, 0, 0}, {159, 0, 0}, {170, 0, 0}, {181, 0, 0}, {191, 0, 0}, {202, 0, 0}, {213, 0, 0}, {223, 0, 0}, {234, 0, 0}, {244, 0, 0}, {255, 0, 0}, {255, 11, 0}, {255, 21, 0}, {255, 32, 0}, {255, 43, 0}, {255, 53, 0}, {255, 64, 0}, {255, 74, 0}, {255, 85, 0}, {255, 96, 0}, {255, 106, 0}, {255, 117, 0}, {255, 128, 0}, {255, 138, 0}, {255, 149, 0}, {255, 159, 0}, {255, 170, 0}, {255, 181, 0}, {255, 191, 0}, {255, 202, 0}, {255, 213, 0}, {255, 223, 0}, {255, 234, 0}, {255, 244, 0}, {255, 255, 0}, {255, 255, 16}, {255, 255, 32}, {255, 255, 48}, {255, 255, 64}, {255, 255, 80}, {255, 255, 96}, {255, 255, 112}, {255, 255, 128}, {255, 255, 143}, {255, 255, 159}, {255, 255, 175}, {255, 255, 191}, {255, 255, 207}, {255, 255, 223}, {255, 255, 239}, {255, 255, 255}};
    else if (map == "turbo")
        cmap = {{48, 18, 59}, {53, 30, 89}, {57, 42, 116}, {61, 54, 140}, {64, 65, 163}, {67, 76, 183}, {68, 87, 200}, {70, 98, 215}, {70, 108, 228}, {71, 119, 239}, {70, 129, 247}, {69, 139, 253}, {65, 149, 255}, {60, 159, 253}, {53, 170, 249}, {46, 180, 242}, {39, 189, 234}, {33, 199, 224}, {28, 207, 213}, {24, 215, 202}, {24, 222, 192}, {26, 228, 182}, {33, 234, 172}, {42, 239, 161}, {54, 243, 148}, {67, 247, 134}, {83, 250, 121}, {98, 252, 107}, {114, 254, 94}, {130, 255, 82}, {144, 255, 72}, {157, 254, 64}, {168, 252, 58}, {179, 248, 54}, {189, 244, 52}, {200, 239, 52}, {209, 233, 53}, {218, 226, 54}, {227, 219, 56}, {234, 211, 57}, {241, 203, 58}, {246, 195, 58}, {250, 186, 57}, {252, 177, 54}, {254, 166, 50}, {254, 155, 45}, {253, 143, 40}, {252, 131, 35}, {249, 119, 30}, {246, 107, 25}, {242, 95, 20}, {237, 84, 15}, {231, 74, 12}, {225, 66, 9}, {218, 57, 7}, {211, 50, 5}, {202, 42, 4}, {193, 35, 2}, {183, 29, 2}, {173, 23, 1}, {161, 18, 1}, {149, 13, 1}, {136, 8, 2}, {122, 4, 3}};
    else if (map == "copper")
        cmap = {{0, 0, 0}, {5, 3, 2}, {10, 6, 4}, {15, 9, 6}, {20, 13, 8}, {25, 16, 10}, {30, 19, 12}, {35, 22, 14}, {40, 25, 16}, {46, 28, 18}, {51, 32, 20}, {56, 35, 22}, {61, 38, 24}, {66, 41, 26}, {71, 44, 28}, {76, 47, 30}, {81, 51, 32}, {86, 54, 34}, {91, 57, 36}, {96, 60, 38}, {101, 63, 40}, {106, 66, 42}, {111, 70, 44}, {116, 73, 46}, {121, 76, 48}, {126, 79, 50}, {132, 82, 52}, {137, 85, 54}, {142, 89, 56}, {147, 92, 58}, {152, 95, 60}, {157, 98, 62}, {162, 101, 64}, {167, 104, 66}, {172, 108, 68}, {177, 111, 70}, {182, 114, 72}, {187, 117, 75}, {192, 120, 77}, {197, 123, 79}, {202, 126, 81}, {207, 130, 83}, {212, 133, 85}, {218, 136, 87}, {223, 139, 89}, {228, 142, 91}, {233, 145, 93}, {238, 149, 95}, {243, 152, 97}, {248, 155, 99}, {253, 158, 101}, {255, 161, 103}, {255, 164, 105}, {255, 168, 107}, {255, 171, 109}, {255, 174, 111}, {255, 177, 113}, {255, 180, 115}, {255, 183, 117}, {255, 187, 119}, {255, 190, 121}, {255, 193, 123}, {255, 196, 125}, {255, 199, 127}};
    else if (map == "spring")
        cmap = {{255, 0, 255}, {255, 4, 251}, {255, 8, 247}, {255, 12, 243}, {255, 16, 239}, {255, 20, 235}, {255, 24, 231}, {255, 28, 227}, {255, 32, 223}, {255, 36, 219}, {255, 40, 215}, {255, 45, 210}, {255, 49, 206}, {255, 53, 202}, {255, 57, 198}, {255, 61, 194}, {255, 65, 190}, {255, 69, 186}, {255, 73, 182}, {255, 77, 178}, {255, 81, 174}, {255, 85, 170}, {255, 89, 166}, {255, 93, 162}, {255, 97, 158}, {255, 101, 154}, {255, 105, 150}, {255, 109, 146}, {255, 113, 142}, {255, 117, 138}, {255, 121, 134}, {255, 125, 130}, {255, 130, 125}, {255, 134, 121}, {255, 138, 117}, {255, 142, 113}, {255, 146, 109}, {255, 150, 105}, {255, 154, 101}, {255, 158, 97}, {255, 162, 93}, {255, 166, 89}, {255, 170, 85}, {255, 174, 81}, {255, 178, 77}, {255, 182, 73}, {255, 186, 69}, {255, 190, 65}, {255, 194, 61}, {255, 198, 57}, {255, 202, 53}, {255, 206, 49}, {255, 210, 45}, {255, 215, 40}, {255, 219, 36}, {255, 223, 32}, {255, 227, 28}, {255, 231, 24}, {255, 235, 20}, {255, 239, 16}, {255, 243, 12}, {255, 247, 8}, {255, 251, 4}, {255, 255, 0}};
    else if (map == "cool")
        cmap = {{0, 255, 255}, {4, 251, 255}, {8, 247, 255}, {12, 243, 255}, {16, 239, 255}, {20, 235, 255}, {24, 231, 255}, {28, 227, 255}, {32, 223, 255}, {36, 219, 255}, {40, 215, 255}, {45, 210, 255}, {49, 206, 255}, {53, 202, 255}, {57, 198, 255}, {61, 194, 255}, {65, 190, 255}, {69, 186, 255}, {73, 182, 255}, {77, 178, 255}, {81, 174, 255}, {85, 170, 255}, {89, 166, 255}, {93, 162, 255}, {97, 158, 255}, {101, 154, 255}, {105, 150, 255}, {109, 146, 255}, {113, 142, 255}, {117, 138, 255}, {121, 134, 255}, {125, 130, 255}, {130, 125, 255}, {134, 121, 255}, {138, 117, 255}, {142, 113, 255}, {146, 109, 255}, {150, 105, 255}, {154, 101, 255}, {158, 97, 255}, {162, 93, 255}, {166, 89, 255}, {170, 85, 255}, {174, 81, 255}, {178, 77, 255}, {182, 73, 255}, {186, 69, 255}, {190, 65, 255}, {194, 61, 255}, {198, 57, 255}, {202, 53, 255}, {206, 49, 255}, {210, 45, 255}, {215, 40, 255}, {219, 36, 255}, {223, 32, 255}, {227, 28, 255}, {231, 24, 255}, {235, 20, 255}, {239, 16, 255}, {243, 12, 255}, {247, 8, 255}, {251, 4, 255}, {255, 0, 255}};
    else if (map == "gray")
        cmap = {{0, 0, 0}, {4, 4, 4}, {8, 8, 8}, {12, 12, 12}, {16, 16, 16}, {20, 20, 20}, {24, 24, 24}, {28, 28, 28}, {32, 32, 32}, {36, 36, 36}, {40, 40, 40}, {45, 45, 45}, {49, 49, 49}, {53, 53, 53}, {57, 57, 57}, {61, 61, 61}, {65, 65, 65}, {69, 69, 69}, {73, 73, 73}, {77, 77, 77}, {81, 81, 81}, {85, 85, 85}, {89, 89, 89}, {93, 93, 93}, {97, 97, 97}, {101, 101, 101}, {105, 105, 105}, {109, 109, 109}, {113, 113, 113}, {117, 117, 117}, {121, 121, 121}, {125, 125, 125}, {130, 130, 130}, {134, 134, 134}, {138, 138, 138}, {142, 142, 142}, {146, 146, 146}, {150, 150, 150}, {154, 154, 154}, {158, 158, 158}, {162, 162, 162}, {166, 166, 166}, {170, 170, 170}, {174, 174, 174}, {178, 178, 178}, {182, 182, 182}, {186, 186, 186}, {190, 190, 190}, {194, 194, 194}, {198, 198, 198}, {202, 202, 202}, {206, 206, 206}, {210, 210, 210}, {215, 215, 215}, {219, 219, 219}, {223, 223, 223}, {227, 227, 227}, {231, 231, 231}, {235, 235, 235}, {239, 239, 239}, {243, 243, 243}, {247, 247, 247}, {251, 251, 251}, {255, 255, 255}};
    else if (map == "autumn")
        cmap = {{255, 0, 0}, {255, 4, 0}, {255, 8, 0}, {255, 12, 0}, {255, 16, 0}, {255, 20, 0}, {255, 24, 0}, {255, 28, 0}, {255, 32, 0}, {255, 36, 0}, {255, 40, 0}, {255, 45, 0}, {255, 49, 0}, {255, 53, 0}, {255, 57, 0}, {255, 61, 0}, {255, 65, 0}, {255, 69, 0}, {255, 73, 0}, {255, 77, 0}, {255, 81, 0}, {255, 85, 0}, {255, 89, 0}, {255, 93, 0}, {255, 97, 0}, {255, 101, 0}, {255, 105, 0}, {255, 109, 0}, {255, 113, 0}, {255, 117, 0}, {255, 121, 0}, {255, 125, 0}, {255, 130, 0}, {255, 134, 0}, {255, 138, 0}, {255, 142, 0}, {255, 146, 0}, {255, 150, 0}, {255, 154, 0}, {255, 158, 0}, {255, 162, 0}, {255, 166, 0}, {255, 170, 0}, {255, 174, 0}, {255, 178, 0}, {255, 182, 0}, {255, 186, 0}, {255, 190, 0}, {255, 194, 0}, {255, 198, 0}, {255, 202, 0}, {255, 206, 0}, {255, 210, 0}, {255, 215, 0}, {255, 219, 0}, {255, 223, 0}, {255, 227, 0}, {255, 231, 0}, {255, 235, 0}, {255, 239, 0}, {255, 243, 0}, {255, 247, 0}, {255, 251, 0}, {255, 255, 0}};
    else if (map == "summer")
        cmap = {{0, 128, 102}, {4, 130, 102}, {8, 132, 102}, {12, 134, 102}, {16, 136, 102}, {20, 138, 102}, {24, 140, 102}, {28, 142, 102}, {32, 144, 102}, {36, 146, 102}, {40, 148, 102}, {45, 150, 102}, {49, 152, 102}, {53, 154, 102}, {57, 156, 102}, {61, 158, 102}, {65, 160, 102}, {69, 162, 102}, {73, 164, 102}, {77, 166, 102}, {81, 168, 102}, {85, 170, 102}, {89, 172, 102}, {93, 174, 102}, {97, 176, 102}, {101, 178, 102}, {105, 180, 102}, {109, 182, 102}, {113, 184, 102}, {117, 186, 102}, {121, 188, 102}, {125, 190, 102}, {130, 192, 102}, {134, 194, 102}, {138, 196, 102}, {142, 198, 102}, {146, 200, 102}, {150, 202, 102}, {154, 204, 102}, {158, 206, 102}, {162, 208, 102}, {166, 210, 102}, {170, 212, 102}, {174, 215, 102}, {178, 217, 102}, {182, 219, 102}, {186, 221, 102}, {190, 223, 102}, {194, 225, 102}, {198, 227, 102}, {202, 229, 102}, {206, 231, 102}, {210, 233, 102}, {215, 235, 102}, {219, 237, 102}, {223, 239, 102}, {227, 241, 102}, {231, 243, 102}, {235, 245, 102}, {239, 247, 102}, {243, 249, 102}, {247, 251, 102}, {251, 253, 102}, {255, 255, 102}};
    else
        throw std::invalid_argument("Colormap is not supported.");

    return cmap;
}
